# 35. 项目管理与度量 📅📊🚦

> 这章是一套 **可执行的 Project OS**：从**立项→拆解→排期→交付→观测→复盘**的完整闭环，配好**模板、量表、公式、脚本与清单**。不空谈方法论，落地就能用。

---

## 0）总纲（四句话心法）

1) **先对齐“为什么”**：北极星指标 & 约束条件（成本/时限/质量）。  
2) **小批量快回路**：细粒度里程碑 + 可回滚发布。  
3) **面向数据运营**：定义可计算的“完成”与“成功”。  
4) **可观测**：指标自动上墙，异常自动告警，结果可复盘。

---

## 1）项目形态与节律（Discovery → Delivery）

### 1.1 项目形态（选一个主轴，别混）
- **Flow/Kanban**：持续流入、限 WIP、拉动式。适合平台/中台/维护。  
- **Scrum**：固定 Sprint（1–2 周），承诺—验收。适合节奏稳定的产品增量。  
- **Shape Up**：固定周期（6–8 周）赌注式投放，边界清晰，scope 自裁。适合 0→1/探索性强。

### 1.2 基本节律
- **每周**：周一对齐（Roadmap+风险），周五 Demo/复盘（KPT）。  
- **双周**：计划/回顾（回顾用数据说话）。  
- **每月**：Roadmap 滚动三个月。  
- **每季**：OKR 对齐 & 指标回看（含停做清单）。

---

## 2）从目标到计划：五步走

1) **目标（Objective）**：一句话价值陈述（面向用户/业务）。  
2) **关键结果（KR）**：可量化、可验证。  
3) **范围（In/Out）**：明确不做什么，反 scope creep。  
4) **里程碑（Milestones）**：能 Demo、能回滚、能观测。  
5) **风险/依赖（RAID）**：Risks/Assumptions/Issues/Dependencies。

**One-Pager 模板（PRD/项目立项）**
```md
# {项目名} One-Pager
目的/Why：...
成功度量（KR）：转化+3%，留存+2pp，P95 延迟<200ms
范围/Out：不做跨平台；不改支付流程
里程碑：M1 方案评审(10/08)、M2 试点上线(10/22)、M3 全量(11/05)
风险/依赖：风控规则切换；数据建模需 BI 支持
监控面板：{链接}  回滚剧本：{链接}
DRI：@alice   干系人：@pm @data @ops
```

---

## 3）拆解与估算（用数据降噪）

### 3.1 WBS（工作分解）
- **业务流** → **能力/模块** → **任务**（≤ 2 天/条）。
- 每条任务带 **DoD（Done 定义）** 与 **验收方式**。

### 3.2 估算方法
- **相对估算**：Story Point（只比大小，不比时间）。  
- **吞吐预测**：用历史吞吐（每周完成的卡片数）+ **蒙特卡罗**模拟交付日期。  
- **持续校准**：每 Sprint 回看实际 vs 估算偏差。

**蒙特卡罗（TypeScript 伪）**
```ts
function forecast(samples:number[], trials=5000, target=30) {
  const out:number[] = [];
  for (let i=0;i<trials;i++){
    let done=0, weeks=0;
    while(done<target){ done+=samples[Math.floor(Math.random()*samples.length)]; weeks++; }
    out.push(weeks);
  }
  out.sort((a,b)=>a-b);
  const p50 = out[Math.floor(trials*0.5)];
  const p85 = out[Math.floor(trials*0.85)];
  const p95 = out[Math.floor(trials*0.95)];
  return { p50, p85, p95 }; // 交付需周数
}
```

---

## 4）看板与在制品（WIP）控制

- **工作流列**：Backlog → Ready → In Progress → Review → Verify → Done。  
- **WIP 限制**：每列设上限（如 3/人），过线即停新拉单。  
- **泳道**：热修/阻塞/外部依赖单独泳道，保证可见性。  
- **CFD（累计流图）**：观察堆积与瓶颈（Review 堵塞=评审不及时）。

---

## 5）跨团队项目（Program）与依赖管理

- **DACI/RACI**：明确 Driver/Approver/Contributor/Informed。  
- **依赖板 Program Board**：里程碑×团队网格，标注**软/硬依赖**与时序。  
- **Scrum of Scrums**：每周 30min，讨论**风险/依赖/阻塞**（不复述进度）。  
- **变更控制**：变更走 **Change Request（CR）**，必须附影响评估与回滚计划。

**RAID 日志模板**
```md
| 类型 | 描述 | 概率/影响 | Owner | 应对 | 状态 |
| Risk | 节点不支持 TLS1.3 | M/H | @devops | 预检查+回退脚本 | Open |
| Dep  | 支付团队 SDK v3 | H/H | @pay | 对齐发布日期 | Mitigated |
```

---

## 6）发布与回滚（Release Ops）

- **灰度/金丝雀**：5%→20%→50%→100%，每步绑定**止损指标**（错误率/延迟/转化）。  
- **开关（Feature Flags）**：按租户/用户/地域；上线≠曝光。  
- **回滚**：版本化、一键回滚、数据迁移有 **down** 脚本。  
- **事后复盘**：Blameless，输出 **RCA** 与 **行动项**（Owner+DDL）。

---

## 7）指标体系（度量三层）

### 7.1 交付/工程效率（团队）
- **DORA**：部署频率、变更前置时间、变更失败率、MTTR。  
- **Flow**：Lead Time（立项→上线）、Cycle Time（开始→上线）、WIP、Throughput。  
- **质量**：缺陷密度、逃逸缺陷（生产环境）、测试覆盖、静态扫描问题趋势。  
- **可靠性**：SLO/SLA、错误预算（Error Budget）、可用性（99.9/99.99）。  

### 7.2 产品/业务（成果）
- **北极星**：留存/DAU×留存、订单完成率、GMV、单位时长价值。  
- **漏斗**：展示→点击→加购→下单→支付→留存；**转化率** / **分段时延**。  
- **增长 AARRR**：获取/激活/留存/变现/传播。  
- **实验**：OEC（总体评估准则）+ Guardrails（错误率/性能/隐私）。

### 7.3 经济与成本（可持续）
- **单位经济**：CAC、LTV、毛利、回本周期。  
- **云成本（FinOps）**：每次发布成本、每请求成本、服务/租户/团队成本归集（标签化）。  
- **ROI**：收益/成本、NPV、Payback。

---

## 8）指标落地：定义 → 采集 → 验证 → 看板

### 8.1 指标定义（Metric Contract）
```md
Name: checkout_conversion
Type: ratio
Owner: @data
Formula: orders_success / checkout_sessions
Filters: country, device, channel
Latency: T+5min
QA: AA-test每季一次；SRM 检测阈值 p<0.01
```

### 8.2 采集与验证
- **事件命名**：`verb_object`（`click_buy`, `view_product`），必须有 `ts,user_id,session_id`。  
- **质量**：AA 测试、**SRM 检测**（样本比例失衡）、埋点回放/对账。  
- **治理**：指标字典、Owner、变更记录（版本化）。

### 8.3 看板结构（建议）
- **层 1**：北极星 & 关键漏斗  
- **层 2**：工程健康（DORA/Flow/SLO）  
- **层 3**：实验面板（实验→指标→显著性）  
- **层 4**：成本（服务/租户/功能维度）

---

## 9）A/B 实验：严谨但不繁琐

- **设计**：先定 OEC 与 Guardrails，再定样本量（功效分析、α/β）。  
- **执行**：随机、互斥、等概率；支持**分层**（国家/设备）与**排除名单**。  
- **统计**：固定时窗或序贯检验；避免**p-hacking**；报告包含**效应大小/置信区间**。  
- **上线**：实验结果进入 **ADR/变更记录**；失败也要记录“为何失败”。

**SRM 检测（SQL 示意）**
```sql
-- 两组样本占比显著偏离 50/50 就报警（卡方）
SELECT group_id, COUNT(*) n FROM assignments WHERE exp_id = $1 GROUP BY 1;
```

---

## 10）SLO/错误预算与发布节流

- **SLO** 示例：`P95 /checkout ≤ 300ms`，`可用性 ≥ 99.9%`。  
- **错误预算**：`Budget = 1 - SLO`，超支 → **冻结发布**，只允许可靠性改进。  
- **门禁**：发布流水线读取 SLO 告警，超过阈值禁止上产。

---

## 11）进度健康度与预警

- **绿/黄/红**：按“交付燃尽 vs 价值燃起”双轴判断。  
- **预警信号**：CFD 扩散、Review 堵塞、缺陷回归、指标反弹、依赖方延误。  
- **处置**：砍 scope、加里程碑、重排依赖、技术除险（Spike）。

---

## 12）沟通与汇报（Stakeholders）

- **节奏**：周报（要点 5 行内 + 看板链接）、月度复盘（数据驱动）。  
- **四象限汇报**：目标/进展/风险/诉求。  
- **透明**：把“未知/不确定”写出来，别让领导猜。  
- **单一事实源**：Roadmap & 看板 & 指标链接固定不变。

---

## 13）质量与验收（DoR/DoD）

**DoR（Ready）**
- [ ] 验收标准清晰、可测试  
- [ ] 依赖已识别并可用  
- [ ] 风险与回滚思路已写  
- [ ] 监控与埋点方案已评审

**DoD（Done）**
- [ ] 代码已评审、测试通过（含 E2E 关键路径）  
- [ ] 监控上线、告警门限设定  
- [ ] 文档/Runbook/Feature Flag 更新  
- [ ] 已在预发/灰度用户验证

---

## 14）成本与产出（FinOps × 工程）

**服务成本公式（简）**  
`Cost_per_req = (Compute + Storage + Network + Third-Party) / Requests`

**优化抓手**
- 热点路由缓存、冷链归档；无用日志采样降噪；按租户限流/配额；容量预测与预留实例。

---

## 15）反模式清单（看到就掐掉）🙅‍♀️

| 反模式 | 体现 | 替代 |
|---|---|---|
| 以 Velocity 设 KPI | 团队膨胀点数/拆票造假 | 用 **吞吐+Lead Time** 与结果指标 |
| 会议报进度 | 复述无产出 | 异步看板 + “问题/风险/决策”会 |
| 一把梭上线 | 无灰度、无回滚 | 金丝雀 + Flag + 回滚剧本 |
| 指标堆砌 | 看板一屏 20 图 | 层级化：北极星 → 工程 → 成本 |
| 需求漏斗黑箱 | 说了就做 | DoR/DoD+One-Pager+CR 流程 |

---

## 16）模板仓（可复制）

**项目 Roadmap（季度级）**
```md
Q4 目标 & KR：{...}
Epics:
- E1 结账重构（Owner@a）  M1/M2/M3
- E2 指标治理（Owner@b）  M1/M2
风险：...
链接：看板、指标、文档
```

**周报（5×5 模板）**
```md
# Week 35 报告（项目X）
1) 达成：M2 完成灰度；错误率<0.2%
2) 下周：支付改造上线、实验A收尾
3) 风险：依赖SDK v3 发布延迟（@pay跟进）
4) 数据：Throughput=18, LeadTime p50=2.3d
5) 诉求：BI 支持转化漏斗维度拆分
```

**变更请求（CR）**
```md
变更：将服务A超时从 2s→1s
原因：保护下游B
影响：可能 0.3% 超时增多
回滚：值回调 2s
验证：AB 实验 & 错误率监控
批准：@approver 截止：2025-10-01
```

---

## 17）Checklist（上线前最后一眼）✅

- [ ] One-Pager/DoR/DoD 齐全，范围清晰  
- [ ] RAID/依赖可见，Owner 明确  
- [ ] 估算有**吞吐/蒙卡**，非拍脑袋  
- [ ] 看板+CFD 可用，WIP 有上限  
- [ ] 灰度/Flag/回滚脚本就绪，SLO 门禁生效  
- [ ] 指标：北极星/漏斗/工程/成本 四层上墙  
- [ ] 实验：OEC+Guardrails+样本量与 SRM 检测  
- [ ] 复盘机制固定，行动项有 Owner+DDL

---

### 结语

项目管理不是“表格+周会”，而是一套**可编排的生产系统**。把**目标—计划—交付—度量—复盘**串起来，用**数据**驱动**节律**，用**小批量**降低风险，用**可观测**保证进化，你的团队就会自然地越跑越快、越做越稳。🏁
